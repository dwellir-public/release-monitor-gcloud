application: release-monitor-gcloud
application-config:
  trust:
    default: false
    description: Does this application have access to trusted credentials
    source: default
    type: bool
    value: false
charm: release-monitor-gcloud
settings:
  artifact-selection-default-binary-patterns:
    default: '[]'
    description: |
      JSON array of default binary extraction patterns.
      Rendered runtime key: artifact_selection.default_binary_patterns.
      Example: '["rpc-node-*", "*/rpc-node-*"]'
    source: default
    type: string
    value: '[]'
  artifact-selection-default-genesis-patterns:
    default: '[]'
    description: |
      JSON array of default genesis extraction patterns.
      Rendered runtime key: artifact_selection.default_genesis_patterns.
      Example: '["mainnet/genesis.json", "*/mainnet/genesis.json"]'
    source: default
    type: string
    value: '[]'
  artifact-selection-enabled:
    default: true
    description: Enable artifact extraction rules.
    source: default
    type: boolean
    value: true
  artifact-selection-fallback-to-archive:
    default: true
    description: Fallback to archive upload when extraction fails.
    source: default
    type: boolean
    value: true
  artifact-selection-rules:
    default: '[]'
    description: |
      JSON array of artifact selection rule objects.
      Rendered runtime key: artifact_selection.rules.
      Example: '[{"organization":"megaeth","repository":"megaeth-rpc","binary_patterns":["rpc-node-*"],"genesis_patterns":["mainnet/genesis.json"]}]'
    source: user
    type: string
    value: '[{"organization":"megaeth","repository":"megaeth-rpc","binary_patterns":["rpc-node-*","*/rpc-node-*"],"genesis_patterns":["mainnet/genesis.json","*/mainnet/genesis.json","testnet/genesis.json","*/testnet/genesis.json"]}]'
  chain-client-name:
    default: ""
    description: Optional client name.
    source: user
    type: string
    value: mega-reth
  chain-common-name:
    default: ""
    description: |
      Display/common name. Empty falls back to chain-repository.
      Rendered runtime key: chain.common_name.
    source: user
    type: string
    value: MegaETH RPC
  chain-extra-info:
    default: ""
    description: Optional release metadata context.
    source: user
    type: string
    value: Binary metadata detected from Google Cloud Storage and forwarded by webhook.
  chain-genesis-hashes:
    default: '[]'
    description: |
      JSON array of genesis hashes.
      Rendered runtime key: chain.genesis_hashes.
      Example: '["0x1234..."]'
    source: default
    type: string
    value: '[]'
  chain-ids:
    default: '[]'
    description: |
      JSON array of integer chain IDs.
      Rendered runtime key: chain.chain_ids.
      Example: '[4326]'
    source: user
    type: string
    value: '[4326]'
  chain-organization:
    default: ""
    description: |
      Required. Source chain organization.
      Rendered runtime key: chain.organization.
    source: user
    type: string
    value: megaeth
  chain-repository:
    default: ""
    description: |
      Required. Source chain repository.
      Rendered runtime key: chain.repository.
    source: user
    type: string
    value: megaeth-rpc
  delivery-mode:
    default: full
    description: |
      Artifact delivery mode. full uploads to Nextcloud; webhook_only skips upload and sends webhook only.
      Rendered runtime key: delivery_mode.
      Example: webhook_only
    source: default
    type: string
    value: full
  gcs-anonymous:
    default: false
    description: Use anonymous GCS access.
    source: default
    type: boolean
    value: false
  gcs-bucket:
    default: ""
    description: |
      Required. GCS bucket name.
      Rendered runtime key: gcs.bucket.
    source: user
    type: string
    value: megaeth-public-node-packages
  gcs-include-content-types:
    default: '[]'
    description: |
      JSON array of accepted MIME types.
      Rendered runtime key: gcs.include_content_types.
      Example: '["application/gzip", "application/octet-stream"]'
    source: user
    type: string
    value: '["application/x-tar","application/gzip","application/octet-stream"]'
  gcs-include-prefixes:
    default: '[]'
    description: |
      JSON array of object name prefixes.
      Rendered runtime key: gcs.include_prefixes.
      Example: '["v2.0.7/"]'
    source: default
    type: string
    value: '[]'
  gcs-include-suffixes:
    default: '[]'
    description: |
      JSON array of candidate archive suffixes.
      Rendered runtime key: gcs.include_suffixes.
      Example: '[".tar.gz", ".tgz"]'
    source: user
    type: string
    value: '[".tar.gz",".tgz"]'
  gcs-service-account-secret-id:
    default: ""
    description: |
      Secret ID containing key service-account-json.
      Used when gcs-anonymous=false and gcs-use-gcloud-cli=false.
      Rendered runtime key impact: writes gcs.credentials_file from secret content.
    source: user
    type: string
    value: secret:d6arj90e9vupqhq8th60
  gcs-use-gcloud-cli:
    default: false
    description: Use local gcloud CLI auth mode.
    source: default
    type: boolean
    value: false
  log-level:
    default: INFO
    description: CLI log level for gcs-release-monitor.
    source: default
    type: string
    value: INFO
  nextcloud-base-url:
    default: ""
    description: |
      Required when delivery-mode=full. Nextcloud base URL.
      Rendered runtime key: nextcloud.base_url.
    source: user
    type: string
    value: https://nextcloud.dwellir.com
  nextcloud-create-public-share:
    default: true
    description: Create public share links for uploaded artifacts.
    source: default
    type: boolean
    value: true
  nextcloud-credentials-secret-id:
    default: ""
    description: |
      Required when delivery-mode=full. Secret ID with username/app-password, optional share-password.
      Rendered runtime keys sourced from this secret: nextcloud.username, nextcloud.app_password, nextcloud.share_password.
    source: user
    type: string
    value: secret:d6argfge9vupqhq8th5g
  nextcloud-remote-dir:
    default: ""
    description: |
      Required when delivery-mode=full. Remote Nextcloud root directory for uploads.
      Rendered runtime key: nextcloud.remote_dir.
      Example: EXTERNAL/FILESHARES/CLIENT_BINARIES
    source: user
    type: string
    value: EXTERNAL/FILESHARES/CLIENT_BINARIES
  nextcloud-share-expire-days:
    default: 0
    description: Public share expiration in days; 0 omits field.
    source: default
    type: int
    value: 0
  nextcloud-share-permissions:
    default: 1
    description: Nextcloud share permission bitmask.
    source: default
    type: int
    value: 1
  nextcloud-verify-tls:
    default: true
    description: Verify TLS for Nextcloud API calls.
    source: default
    type: boolean
    value: true
  poll-interval-seconds:
    default: 900
    description: |
      Polling interval for release monitor loop.
      Rendered runtime key: poll_interval_seconds.
    source: default
    type: int
    value: 900
  release-defaults-due-date:
    default: P2D
    description: Default due date window (P1D, P2D, P5D).
    source: default
    type: string
    value: P2D
  release-defaults-priority:
    default: 3
    description: Default priority in webhook payload.
    source: default
    type: int
    value: 3
  release-defaults-urgent:
    default: false
    description: Default urgent flag in webhook payload.
    source: default
    type: boolean
    value: false
  state-dir:
    default: /var/lib/release-monitor-gcloud/state
    description: |
      State directory passed to app config.
      Rendered runtime key: state_dir.
    source: default
    type: string
    value: /var/lib/release-monitor-gcloud/state
  temp-dir:
    default: /var/lib/release-monitor-gcloud/tmp
    description: |
      Temporary download directory passed to app config.
      Rendered runtime key: temp_dir.
    source: default
    type: string
    value: /var/lib/release-monitor-gcloud/tmp
  webhook-shared-secret-secret-id:
    default: ""
    description: |
      Fallback secret ID containing key shared-secret.
      Used when webhook relation does not provide credentials.
      Rendered runtime key: webhook.shared_secret.
    source: default
    type: string
    value: ""
  webhook-timeout-seconds:
    default: 10
    description: Webhook HTTP timeout.
    source: default
    type: int
    value: 10
  webhook-url:
    default: ""
    description: |
      Fallback webhook URL when relation is absent.
      Rendered runtime key: webhook.url.
      Example: https://release-filter.example/v1/releases
    source: default
    type: string
    value: ""
  webhook-verify-tls:
    default: true
    description: Verify TLS for webhook endpoint.
    source: default
    type: boolean
    value: true
